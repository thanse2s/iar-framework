<mat-accordion *ngIf="evaluationRecord.length > 0">
  <mat-expansion-panel *ngFor="let evaluationRecord of evaluationRecord; let i = index" [expanded]="open === i" (opened)="open = i" [disabled]="evaluationRecord.is_committed">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Record of the year {{evaluationRecord.year}} for Employee {{evaluationRecord.employee_id}}
      </mat-panel-title>
      <mat-panel-description>
        Total Bonus-Salary: {{this.calculateTotalBonusSalary(evaluationRecord)}}€,  Already Committed: {{findBonusSalaryByIDAndYear(evaluationRecord.employee_id, evaluationRecord.year)}}€
      </mat-panel-description>
      <mat-icon *ngIf="evaluationRecord.is_committed">check</mat-icon>
    </mat-expansion-panel-header>
    <table *ngIf = "evaluationRecord.orders_evaluation" class="output_table">
      <tr>
        <th>Name of Product:</th>
        <th>Client:</th>
        <th>Client Ranking:</th>
        <th>Items:</th>
        <th>Bonus:</th>
        <th>Comment:</th>
      </tr>
      <tr *ngFor="let orderEvaluation of evaluationRecord.orders_evaluation; let j = index">
        <td>{{orderEvaluation.name_of_product}}</td>
        <td>{{orderEvaluation.client}}</td>
        <td>{{orderEvaluation.client_ranking}}</td>
        <td>{{orderEvaluation.items}}</td>
        <td>
          <mat-form-field [formGroup]="findFieldsInRelation(orderEvaluation).fields" class="bonus-field" appearance="outline" >
            <mat-label>Bonus</mat-label>
            <input matInput type="number" formControlName="bonus" placeholder="0" min ="0">
            <mat-icon matPrefix color="primary">euro</mat-icon>
          </mat-form-field>
        </td>
        <td>
          <form>
            <mat-form-field [formGroup]="findFieldsInRelation(orderEvaluation).fields" class="comment-field" appearance="outline">
              <mat-label>Leave a comment</mat-label>
              <textarea matInput formControlName="comment" placeholder="Ex. nice one!"></textarea>
            </mat-form-field>
          </form>
        </td>
      </tr>
    </table>

    <table id="socialpTable" class="output_table">
      <tr>
        <th>Skill/Competence:</th>
        <th>Target Value:</th>
        <th>Actual Value:</th>
        <th>Bonus:</th>
        <th>Comment:</th>
      </tr>
      <tr *ngFor="let socialPerformance of evaluationRecord.social_performance; let j = index">
        <td>{{socialPerformance.description}}</td>
        <td>{{socialPerformance.target_value}}</td>
        <td>{{socialPerformance.actual_value}}</td>
        <td>
          <form>
            <mat-form-field [formGroup]="findFieldsInRelation(socialPerformance).fields" class="bonus-field" appearance="outline">
              <mat-label>Bonus</mat-label>
              <input matInput type="number" formControlName="bonus" placeholder="0" min="0">
              <mat-icon matPrefix color="primary">euro</mat-icon>
            </mat-form-field>
          </form>
        </td>
        <td>
          <form>
            <mat-form-field [formGroup]="findFieldsInRelation(socialPerformance).fields" class="comment-field" appearance="outline">
              <mat-label>Leave a comment</mat-label>
              <textarea matInput formControlName="comment" placeholder="Ex. good job!"></textarea>
            </mat-form-field>
          </form>
        </td>
      </tr>
    </table>
    <mat-action-row>
      <button mat-raised-button color="warn" (click)="commitBonus(evaluationRecord)">Commit</button>
    </mat-action-row>
  </mat-expansion-panel>
</mat-accordion>
<div class="center" *ngIf="evaluationRecord.length === 0">
  <h2>Nothing to do here!</h2>
</div>
