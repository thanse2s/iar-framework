<mat-accordion>
  <mat-expansion-panel *ngFor="let evaluationRecord of evaluationRecord; let i = index" [disabled]="editMode">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Record of the year {{evaluationRecord.year}} for Employee {{evaluationRecord.employee_id}}
      </mat-panel-title>
      <mat-panel-description>
        Total Bonus-Salary of this year: {{this.calculateTotalBonusSalary(evaluationRecord)}}€, Already Committed: {{findBonusSalaryByIDAndYear(evaluationRecord.employee_id, evaluationRecord.year)}}€
      </mat-panel-description>
    </mat-expansion-panel-header>
    <table *ngIf = "evaluationRecord.orders_evaluation" class="output_table">
      <tr>
        <th>Name of Product:</th>
        <th>Client:</th>
        <th>Client Ranking:</th>
        <th>Items:</th>
        <th>Bonus:</th>
        <th>Comment:</th>
      </tr>
      <tr *ngFor="let orderEvaluation of evaluationRecord.orders_evaluation; let j = index">
        <td>{{orderEvaluation.name_of_product}}</td>
        <td>{{orderEvaluation.client}}</td>
        <td>{{orderEvaluation.client_ranking}}</td>
        <td>{{orderEvaluation.items}}</td>
        <td>
          <mat-form-field [formGroup]="findFieldsInRelation(orderEvaluation).fields" class="bonus-field" appearance="outline" >
            <mat-label>Bonus</mat-label>
            <input matInput type="number" formControlName="bonus" placeholder="0" min ="0">
            <mat-icon matPrefix color="primary">euro</mat-icon>
          </mat-form-field>
        </td>
        <td>
          <form>
            <mat-form-field [formGroup]="findFieldsInRelation(orderEvaluation).fields" class="comment-field" appearance="outline">
              <mat-label>Leave a comment</mat-label>
              <textarea matInput formControlName="comment" placeholder="Ex. nice one!"></textarea>
            </mat-form-field>
          </form>
        </td>
      </tr>
    </table>

    <table id="socialpTable" class="output_table">
      <tr>
        <th>Skill/Competence:</th>
        <th>Target Value:</th>
        <th>Actual Value:</th>
        <th>Bonus:</th>
        <th>Comment:</th>
      </tr>
      <tr *ngFor="let socialPerformance of evaluationRecord.social_performance; let j = index">
        <td>{{socialPerformance.description}}</td>
        <td>{{socialPerformance.target_value}}</td>
        <td>{{socialPerformance.actual_value}}</td>
        <td>
          <form>
            <mat-form-field [formGroup]="findFieldsInRelation(socialPerformance).fields" class="bonus-field" appearance="outline">
              <mat-label>Bonus</mat-label>
              <input matInput type="number" formControlName="bonus" placeholder="0" min="0">
              <mat-icon matPrefix color="primary">euro</mat-icon>
            </mat-form-field>
          </form>
        </td>
        <td>
          <form>
            <mat-form-field [formGroup]="findFieldsInRelation(socialPerformance).fields" class="comment-field" appearance="outline">
              <mat-label>Leave a comment</mat-label>
              <textarea matInput formControlName="comment" placeholder="Ex. good job!"></textarea>
            </mat-form-field>
          </form>
        </td>
      </tr>
    </table>
    <mat-action-row>
      <div class="button-panel">
        <span [@hideButtons]="this.getEditMode()" [formGroup]="this.findFieldsInRecordRelation(evaluationRecord).addSocial">
          <mat-form-field appearance="outline" style="margin-right: 10px">
            <mat-label>Skill/Competence</mat-label>
            <input matInput type="text" formControlName="skill" placeholder="Openness to Employees">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Target Value</mat-label>
            <input matInput type="number" formControlName="target" placeholder="5" min="0" max="10">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Actual Value</mat-label>
            <input matInput type="number" formControlName="actual" placeholder="5" min="0" max="10">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Bonus</mat-label>
            <input matInput type="number" formControlName="bonus" placeholder="0" min="0">
            <mat-icon matPrefix color="primary">euro</mat-icon>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Leave a comment</mat-label>
            <textarea matInput formControlName="comment" placeholder="Leave a helpful comment :)" matTextareaAutosize matAutosizeMinRows=1 matAutosizeMaxRows=5></textarea>
          </mat-form-field>
          <button mat-fab aria-label="Add" color="primary" id="add-button" [disabled]="!editMode" (click)="this.addSocialPerformance(evaluationRecord)">
            <mat-icon>add</mat-icon>
          </button>
          <button mat-fab aria-label="Save" color="primary" id="save-button" [disabled]="!editMode" (click)="this.saveChanges()">
            <mat-icon>save</mat-icon>
          </button>
          <button mat-fab aria-label="Undo" color="warn" id="undo-button" [disabled]="!editMode" (click)="this.undoChanges()">
            <mat-icon>undo</mat-icon>
          </button>
        </span>
        <button mat-fab aria-label="Edit" color="primary" id="edit-button" [disabled]="editMode" (click)="this.enterEditMode(evaluationRecord)">
          <mat-icon>edit</mat-icon>
        </button>
      </div>
    </mat-action-row>
  </mat-expansion-panel>
</mat-accordion>
